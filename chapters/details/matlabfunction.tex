\begin{figure}[ht]
    \centering
    \resizebox{\linewidth}{!}{
        \begin{tikzpicture}[auto, node distance=2cm,>=latex']
            % Nodes
            \node [input, name=Vbc] {};
            \node [input, name=Vab, above of=Vbc,node distance=0.7cm] {};
            \node [input, name=Vca, below of=Vbc, node distance=0.7cm] {};
            \node [block, right of=Vbc,node distance=3cm] (phaseline) {Phase-Line Transform};
            \node [block, right of=phaseline,node distance=5cm, minimum height=3cm, minimum width=4cm] (PLL) {Phase Lock Loop};
            \node [block, right of=PLL,yshift=0.5cm,node distance=10cm, minimum height=2.5cm, minimum width=3.5cm] (iclarke) {Inverse Clarke Transform};

            \node [input, name=Ibc, below of=Vbc, node distance=8cm] {};
            \node [input, name=Iab, above of=Ibc,node distance=1cm] {};
            \node [input, name=Ica, below of=Ibc, node distance=1cm] {};
            \node [block, right of=Ibc, node distance=3.5cm, minimum height=3.5cm, minimum width=4.5cm] (park) {Park Transform};

            \node [sum, name=sumID, right of=PLL, yshift=1cm, node distance =5cm]{$+$};
            \node [sum, name=sumIQ, right of=PLL, node distance=6.5cm]{$+$};

            \node [block, name=svm, right of=PLL, node distance=15.5cm, minimum height=3.5cm, minimum width=4.5cm]{Space Vector Modulation};

            \node [block, name=piID, right of=park, node distance=6.5cm, yshift=1cm]{PI\\Controller};
            \node [block, name=piIQ, right of=park, node distance=6.5cm, yshift=-1cm]{PI\\Controller};

            \node [sum, name=setIQ, left of=piID, node distance=2.5cm]{};
            \node [sum, name=setID, left of=piIQ, node distance=2.5cm]{};

            \node [input, name=Id, below of=setID, node distance=2cm]{};
            \node [input, name=Iq, above of=setIQ, node distance=2cm]{};
            
            \node [output, name=gb, right of=svm, node distance=4cm]{};
            \node [output, name=ga, above of=gb, node distance=1cm]{};
            \node [output, name=gc, below of=gb, node distance=1cm]{};

            % Connections
            \draw[->] (Vab) node[above]{$V_{ab}$} -- ([yshift=0.7cm]phaseline.west);
            \draw[->] (Vbc) node[above]{$V_{bc}$} -- (phaseline.west);
            \draw[->] (Vca) node[above]{$V_{ca}$} -- ([yshift=-0.7cm]phaseline.west);

            \draw[->] ([yshift=0.7cm]phaseline.east) node[above right]{$V_{a}$} -- ([yshift=0.7cm]PLL.west);
            \draw[->] (phaseline.east) node[above right]{$V_{b}$} -- (PLL.west);
            \draw[->] ([yshift=-0.7cm]phaseline.east) node[above right]{$V_{c}$} -- ([yshift=-0.7cm]PLL.west);

            \draw[->] (Iab) node[above]{$I_{a}$} -- ([yshift=1cm]park.west);
            \draw[->] (Ibc) node[above]{$I_{b}$} -- (park.west);
            \draw[->] (Ica) node[above]{$I_{c}$} -- ([yshift=-1cm]park.west);

            \draw[->] ([yshift=1cm]PLL.east) node[above right]{$V_d$} -- (sumID.west);
            \draw[->] (PLL.east) node[above right]{$V_q$} -- (sumIQ.west);
            \draw[->] (sumID.east) node[above right]{$V_d^*$} -- ([yshift =0.5cm]iclarke.west);
            \draw[->] (sumIQ.east) node[above right]{$V_q^*$} -- ([yshift =-0.5cm]iclarke.west);

            \draw[->] ([yshift=0.5cm]iclarke.east) node[above right]{$V_\alpha^*$} -- ([yshift=1cm]svm.west);
            \draw[->] ([yshift=-0.5cm]iclarke.east) node[above right]{$V_\beta^*$} -- (svm.west);
            \draw[->] ([yshift=-1cm]PLL.east) node[above right]{$\theta$} -- ([yshift=-1cm]svm.west);

            \draw[->] (piID.east) node[above right]{$\Delta V_d$} -|(sumID.south);
            \draw[->] (piIQ.east) node[above right]{$\Delta V_q$} -|(sumIQ.south);

            \draw[->] (setIQ.east) -- (piID.west);
            \draw[->] (setID.east) -- (piIQ.west);

            \draw[->] (Iq) node[right]{$I_q^*$} -- (setIQ.north);
            \draw[->] (Id) node[right]{$I_d^*$} -- (setID.south);

            \draw[->] ([yshift=1cm]park.east) node[above right]{$I_q$} -- (setIQ.west);
            \draw[->] ([yshift=-1cm]park.east) node[above right]{$I_d$} -- (setID.west);

            \draw[->] ([yshift=-1cm,xshift=2cm]PLL.east)--([yshift=-3.5cm,xshift=2cm]PLL.east)-|(park.north);

            \draw[->] ([yshift=1cm]svm.east) node[above right]{$V_a^*$} -- (ga);
            \draw[->] (svm.east) node[above right]{$V_b^*$} -- (gb);
            \draw[->] ([yshift=-1cm]svm.east) node[above right]{$V_c^*$} -- (gc);
        \end{tikzpicture}
    }
    \caption{Active Front End Converter}
    \label{fig:FEC}
\end{figure}